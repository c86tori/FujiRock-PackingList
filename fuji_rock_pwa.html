<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>フジロック 持ち物チェックリスト</title>
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="フジロック準備">
    
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIuODleOCuOODreODg+OCryDmjIHjgaHnianOjOOCp+ODg+OCr+ODquOCueODiCIsCiAgInNob3J0X25hbWUiOiAi44OV44K444Ot44OD44Kv5rqW5YKZIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmNGY0ZjQiLAogICJ0aGVtZV9jb2xvciI6ICIjNENBRjUwIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lnZG1sbGQwSnZlRDBpTUNBd0lERXlPQ0F4TWpnaUlIaHRiRzV6UFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eU1EQXdMM04yWnlJK1BIQmhkR2dnWkQwaVRURTJJRGNvZUZScGRtVjJkSGxhVFVGdWJrSmxkV1YyWVU1cUxtNXZlRFZUVVVsRmFrcDZjR3hzWkhabFpqQlJNWE5SV2xSUlNXTnRUWGh5UkhSWGVrNTVhVEp3TjJWS2MydDNRbE5LVWtOd0x6Vm5URWQzT1ZZclNVSjVZWGx1ZEhWblZsUmhWa2N5Vm01aVpFODVSbkE0SWlCbWFXeHNQU0lqTkVOQlJqVXdJaTgrUEM5emRtYysiLAogICAgICAic2l6ZXMiOiAiMTI4eDEyOCIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXQp9">
    
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 10px;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2c3e50;
            margin: 10px 0;
            font-size: 1.5em;
        }
        
        .progress-bar {
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 8px;
            background-color: #4CAF50;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        
        .progress-text {
            font-size: 0.9em;
            color: #666;
            text-align: center;
            margin-top: 5px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            min-height: 44px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn:hover {
            background-color: #45a049;
        }
        
        .btn-secondary {
            background-color: #666;
        }
        
        .btn-secondary:hover {
            background-color: #555;
        }
        
        h2, h3 {
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 8px;
            margin-top: 25px;
            font-size: 1.2em;
        }
        
        .section {
            margin-bottom: 20px;
        }
        
        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        li {
            padding: 12px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            min-height: 44px;
        }
        
        input[type="checkbox"] {
            margin-right: 15px;
            transform: scale(1.3);
            cursor: pointer;
            min-width: 20px;
            min-height: 20px;
        }
        
        label {
            cursor: pointer;
            flex-grow: 1;
            font-size: 1em;
            -webkit-user-select: none;
            user-select: none;
        }
        
        input[type="checkbox"]:checked + label {
            text-decoration: line-through;
            color: #999;
        }
        
        .personal-item {
            color: #d35400;
            font-weight: bold;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 15px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 300px;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 10px 8px;
            text-align: left;
            font-size: 0.9em;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .collapsible {
            cursor: pointer;
            padding: 10px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .collapsible:hover {
            background-color: #e9ecef;
        }
        
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .collapsible-content.active {
            max-height: 1000px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .stat-item {
            text-align: center;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .stat-label {
            font-size: 0.8em;
            color: #666;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 10px 15px;
                margin: 5px;
                border-radius: 10px;
            }
            
            h1 {
                font-size: 1.3em;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        .install-prompt {
            background-color: #e3f2fd;
            border: 1px solid #2196F3;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .install-prompt.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="install-prompt" id="installPrompt">
        <p>📱 このアプリをホーム画面に追加して、いつでも使えるようにしませんか？</p>
        <button class="btn" onclick="showInstallInstructions()">インストール方法を見る</button>
        <button class="btn btn-secondary" onclick="hideInstallPrompt()">後で</button>
    </div>

    <div class="container">
        <div class="header">
            <h1>🎵 フジロック持ち物チェックリスト</h1>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">0% 完了 (0/0)</div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalItems">0</div>
                <div class="stat-label">総アイテム</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="checkedItems">0</div>
                <div class="stat-label">完了</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="remainingItems">0</div>
                <div class="stat-label">残り</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" onclick="checkAll()">✅ 全てチェック</button>
            <button class="btn btn-secondary" onclick="uncheckAll()">🔄 全てリセット</button>
            <button class="btn btn-secondary" onclick="resetData()">🗑️ データクリア</button>
        </div>

        <div class="section">
            <h2>🏆【殿堂入り】絶対必需品</h2>
            <ul>
                <li><input type="checkbox" id="item1"><label for="item1">チケット・リストバンド</label></li>
                <li><input type="checkbox" id="item2"><label for="item2">現金・電子マネー</label></li>
                <li><input type="checkbox" id="item3"><label for="item3">スマートフォン</label></li>
                <li><input type="checkbox" id="item4"><label for="item4">健康保険証（コピーでも可）</label></li>
            </ul>
        </div>

        <div class="section">
            <h2>⭐ マストアイテム</h2>
            <ul>
                <li><input type="checkbox" id="item5"><label for="item5">レインウェア（上下セパレートタイプ）</label></li>
                <li><input type="checkbox" id="item6"><label for="item6">履き慣れた防水の靴（トレッキングシューズ・長靴）</label></li>
                <li><input type="checkbox" id="item7"><label for="item7">帽子（あご紐付きの防水ハット）</label></li>
                <li><input type="checkbox" id="item8"><label for="item8">折りたたみ椅子</label></li>
                <li><input type="checkbox" id="item9"><label for="item9">防寒着（フリース・ライトダウン）</label></li>
                <li><input type="checkbox" id="item10"><label for="item10">リュックサック（防水スプレー済み）</label></li>
                <li><input type="checkbox" id="item11"><label for="item11">タオル（速乾性がおすすめ）</label></li>
                <li><input type="checkbox" id="item12"><label for="item12">ジップロック（大小複数枚）</label></li>
                <li><input type="checkbox" id="item13"><label for="item13">汗拭きシート・ウェットティッシュ</label></li>
                <li><input type="checkbox" id="item14"><label for="item14">虫除けスプレー・かゆみ止め</label></li>
                <li><input type="checkbox" id="item15"><label for="item15">ライト（ヘッドライトがおすすめ）</label></li>
                <li><input type="checkbox" id="item16"><label for="item16">水筒・ペットボトルホルダー</label></li>
                <li><input type="checkbox" id="item17"><label for="item17">常備薬・絆創膏</label></li>
            </ul>
        </div>

        <div class="section">
            <h2>👤【あなた専用】パーソナル持ち物リスト</h2>
            <ul>
                <li><input type="checkbox" id="p_item1"><label for="p_item1" class="personal-item">モバイルバッテリー（3つ）</label></li>
                <li><input type="checkbox" id="p_item2"><label for="p_item2" class="personal-item">Apple Watch ＋ 充電器</label></li>
                <li><input type="checkbox" id="p_item3"><label for="p_item3" class="personal-item">髭剃り</label></li>
                <li><input type="checkbox" id="p_item4"><label for="p_item4" class="personal-item">化粧水</label></li>
                <li><input type="checkbox" id="p_item5"><label for="p_item5" class="personal-item">クリーム</label></li>
                <li><input type="checkbox" id="p_item6"><label for="p_item6" class="personal-item">マウスウォッシュ</label></li>
                <li><input type="checkbox" id="p_item7"><label for="p_item7" class="personal-item">サングラス</label></li>
                <li><input type="checkbox" id="p_item8"><label for="p_item8" class="personal-item">CW-X（スポーツタイツ）</label></li>
                <li><input type="checkbox" id="p_item9"><label for="p_item9" class="personal-item">膝サポーター</label></li>
                <li><input type="checkbox" id="p_item10"><label for="p_item10" class="personal-item">日焼け止め</label></li>
                <li><input type="checkbox" id="p_item11"><label for="p_item11" class="personal-item">ヘアスプレー</label></li>
                <li><input type="checkbox" id="p_item12"><label for="p_item12" class="personal-item">洗剤</label></li>
            </ul>
        </div>

        <div class="section">
            <div class="collapsible" onclick="toggleCollapsible(this)">
                <span>👕【参加スタイル別】着替えの枚数ガイド</span>
                <span>▼</span>
            </div>
            <div class="collapsible-content">
                <h3>基本ポイント</h3>
                <p>「滞在日数 ＋ 予備1枚以上」で、素材は乾きやすい化学繊維がおすすめです。</p>
                
                <h3>日帰り参加の場合</h3>
                <div class="table-container">
                    <table>
                        <tr><th>アイテム</th><th>枚数目安</th></tr>
                        <tr><td>Tシャツ</td><td>2枚（着用分＋予備1枚）</td></tr>
                        <tr><td>靴下</td><td>2足（着用分＋予備1足）</td></tr>
                    </table>
                </div>

                <h3>宿・ホテルに宿泊する場合（例：2泊3日）</h3>
                <div class="table-container">
                    <table>
                        <tr><th>アイテム</th><th>枚数目安</th></tr>
                        <tr><td>Tシャツ</td><td>4枚（3日分＋予備1枚）</td></tr>
                        <tr><td>ズボン/ボトムス</td><td>2本（着用分＋予備1本）</td></tr>
                        <tr><td>靴下</td><td>3〜4足（3日分＋予備）</td></tr>
                    </table>
                </div>

                <h3>キャンプサイトに宿泊する場合（例：3泊4日）</h3>
                <div class="table-container">
                    <table>
                        <tr><th>アイテム</th><th>枚数目安</th></tr>
                        <tr><td>Tシャツ</td><td>5〜6枚（4日分＋予備1〜2枚）</td></tr>
                        <tr><td>ズボン/ボトムス</td><td>2〜3本（着用分＋予備1〜2本）</td></tr>
                        <tr><td>靴下</td><td>5足以上</td></tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // データの永続化
        function saveData() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const data = {};
            checkboxes.forEach(checkbox => {
                data[checkbox.id] = checkbox.checked;
            });
            localStorage.setItem('fujiRockChecklist', JSON.stringify(data));
        }

        function loadData() {
            const saved = localStorage.getItem('fujiRockChecklist');
            if (saved) {
                const data = JSON.parse(saved);
                Object.entries(data).forEach(([id, checked]) => {
                    const checkbox = document.getElementById(id);
                    if (checkbox) {
                        checkbox.checked = checked;
                    }
                });
            }
        }

        // 進捗の更新
        function updateProgress() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const total = checkboxes.length;
            const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
            const percentage = total > 0 ? Math.round((checked / total) * 100) : 0;

            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = `${percentage}% 完了 (${checked}/${total})`;
            
            document.getElementById('totalItems').textContent = total;
            document.getElementById('checkedItems').textContent = checked;
            document.getElementById('remainingItems').textContent = total - checked;
        }

        // ボタンの動作
        function checkAll() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = true);
            saveData();
            updateProgress();
        }

        function uncheckAll() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = false);
            saveData();
            updateProgress();
        }

        function resetData() {
            if (confirm('全てのデータをリセットしますか？')) {
                localStorage.removeItem('fujiRockChecklist');
                uncheckAll();
            }
        }

        // 折りたたみ機能
        function toggleCollapsible(element) {
            const content = element.nextElementSibling;
            const arrow = element.querySelector('span:last-child');
            
            content.classList.toggle('active');
            arrow.textContent = content.classList.contains('active') ? '▲' : '▼';
        }

        // インストールプロンプト
        function showInstallInstructions() {
            alert('📱 インストール方法：\n\niOS Safari:\n1. 画面下部の共有ボタン（□↗）をタップ\n2. 「ホーム画面に追加」を選択\n3. 「追加」をタップ\n\nAndroid Chrome:\n1. 画面右上のメニュー（⋮）をタップ\n2. 「ホーム画面に追加」を選択');
            hideInstallPrompt();
        }

        function hideInstallPrompt() {
            document.getElementById('installPrompt').classList.add('hidden');
            localStorage.setItem('installPromptHidden', 'true');
        }

        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateProgress();

            // チェックボックスの変更を監視
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    saveData();
                    updateProgress();
                });
            });

            // インストールプロンプトの表示制御
            if (localStorage.getItem('installPromptHidden')) {
                document.getElementById('installPrompt').classList.add('hidden');
            }

            // PWAインストールイベント
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
            });
        });

        // Service Worker の登録
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:application/javascript;base64,Y29uc3QgQ0FDSEVfTkFNRSA9ICdmdWppLXJvY2stdjEnOwpjb25zdCB1cmxzVG9DYWNoZSA9IFsnLyddOwoKc2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4gewogIGV2ZW50LndhaXRVbnRpbCgKICAgIGNhY2hlcy5vcGVuKENBQ0hFX05BTUUpCiAgICAgIC50aGVuKGNhY2hlID0+IGNhY2hlLmFkZEFsbCh1cmxzVG9DYWNoZSkpCiAgKTsKfSk7CgpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZXZlbnQgPT4gewogIGV2ZW50LnJlc3BvbmRXaXRoKAogICAgY2FjaGVzLm1hdGNoKGV2ZW50LnJlcXVlc3QpCiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlIHx8IGZldGNoKGV2ZW50LnJlcXVlc3QpKQogICk7Cn0pOw==');
        }
    </script>
</body>
</html>